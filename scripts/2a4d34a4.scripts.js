"use strict";angular.module("swallApp",["ngRoute","ngAnimate"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("swallApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("swallApp").directive("postItWall",function(){function a(a,c,d){function e(a){d.remove(a)}function f(a){d.add(a)}var g=a.opts={rows:16,cols:9,capacity:.25};a.$watch(["opts.row","opts.cols","opts.capacity"],function(){g.limit=g.rows*g.cols*g.capacity});var h=function(a,b){function c(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var d,e,f=[];for(d=0;a>d;d++)for(e=0;b>e;e++)f.push({top:100*(d/a)+"%",left:100*(e/b)+"%",width:100*(1/b)+"%",height:100*(1/a)+"%"});return f=c(f),function(c){return f[c%(a*b)]}};a.genStyle=h(g.rows,g.cols),b={list:d.signList,remove:e,add:f,opts:a.opts},a.postIt=b,c.add("post it","glyphicon-th","views/post-it-panel.html",b)}var b;return{controller:["$scope","ControlPanel","DataStore",a],restrict:"E",templateUrl:"views/post-it-wall-tpl.html"}}).animation(".post-it-item",function(){function a(a,b){var c=a.scope(),d=c.genStyle(a.attr("post-it-id"));return a.css({opacity:0,left:0,top:0,width:"100%",height:"100%"}),a.animate({opacity:1,top:d.top,left:d.left,width:d.width,height:d.height},b),function(b){b&&a.stop()}}function b(a,b){a.animate({opacity:0},b)}return{enter:a,leave:b}}),angular.module("swallApp").directive("controlPanel",function(){function a(a,b){a.panels=b.all(),a.activate=function(c){var d=b.activate(c);a.template=d.template,a.ctx=d.ctx},a.inactive=!0,a.toggle=function(){a.inactive=!a.inactive}}return{controller:["$scope","ControlPanel",a],templateUrl:"views/control-panel-tpl.html"}}),angular.module("swallApp").directive("signPad",["$window","$timeout","ControlPanel",function(a,b,c){function d(a,b){function d(a,b,c,d,e,f){this.name=a,this.value=b,this.min=c,this.max=d,this.step=e,this.label=f}a.preview={},a.submit=function(a){b.add(a)},a.preview.update=function(b){a.preview.src=b},a.preview.confirm=function(){a.submit({src:a.preview.src}),a.preview.hide(),a.clearPad()},a.preview.show=function(){a.preview.display=!0},a.preview.hide=function(){a.preview.display=!1},a.params=[new d("min",10,5,20,1,"width"),new d("max",15,5,20,1,"width"),new d("red",90,0,255,1,"red"),new d("green",90,0,255,1,"green"),new d("blue",90,0,255,1,"blue"),new d("smooth",70,0,100,1,"smooth")],c.add("sign pad","glyphicon-edit","views/sign-pad-panel.html",{vals:a.vals,params:a.params})}return{controller:["$scope","DataStore",d],scope:{},templateUrl:"views/sign-pad-tpl.html",restrict:"E",link:function(c,d){function e(){var b=a.devicePixelRatio||1;h.width=h.offsetWidth*b,h.height=h.offsetHeight*b,h.getContext("2d").scale(b,b)}function f(){for(var a=c.params,b=c.vals={},d=0;d<a.length;d++){var e=a[d];b[e.name]=parseInt(e.value,10)}b.min>b.max&&(b.max=b.min+b.max,b.min=b.max-b.min,b.max=b.max-b.min);var f={minWidth:parseFloat(b.min),maxWidth:parseFloat(b.max),color:"rgb("+b.red+","+b.green+","+b.blue+")",velocityFilterWeight:1-b.smooth/100};l.config(f)}var g,h=d.find("canvas")[0],i=300,j=function(){b.cancel(g),c.$apply(function(){c.preview.hide()})},k=function(){b.cancel(g),g=b(function(){c.updatePreview(),c.preview.show()},i)},l=new SignaturePad(h,{startFn:j,endFn:k});a.addEventListener("resize",e),e(),c.updatePreview=function(){c.preview.update(l.toDataURL())},c.clearPad=function(){l.clear()},c.vals={};for(var m in c.params)c.$watch("params["+m+"].value",f)}}}]),angular.module("swallApp").service("ControlPanel",function(){function a(a){return d&&(d.active=!1),d=e[a],d.active=!0,d}function b(a,b,c,d){e.push({name:a,iconClass:b,template:c,ctx:d,active:!1})}function c(){return e}var d,e=[];return{all:c,add:b,activate:a}}),angular.module("swallApp").factory("DataStore",function(){function a(a){a&&(a.id=d(),c.unshift(a))}function b(a){c.splice(a,1)}var c=[],d=function(){var a=0;return function(){var b=a;return a+=1,b}}();return{add:a,remove:b,signList:c}});