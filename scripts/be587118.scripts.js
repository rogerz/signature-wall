"use strict";angular.module("swallApp",["ngRoute","ngAnimate"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("swallApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.options={videoInBg:!0},a.start=function(){a.started=!0,a.$broadcast("start")}}]),angular.module("swallApp").directive("postItWall",function(){function a(a,c,d){function e(a){d.remove(a)}function f(a){d.add(a)}var g=a.opts={grid:6,percent:25};a.$watchCollection("opts",function(){a.limit=g.grid*g.grid*g.percent/100,a.genStyle=h(g.grid,g.grid)});var h=function(a,b){function c(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}var d,e,f=[];for(d=0;a>d;d++)for(e=0;b>e;e++)f.push({top:100*(d/a)+"%",left:100*(e/b)+"%",width:100*(1/b)+"%",height:100*(1/a)+"%"});return f=c(f),function(c){return f[c%(a*b)]}};b={list:d.signList,remove:e,add:f,opts:a.opts},a.postIt=b,c.add("post it","glyphicon-th","views/post-it-panel.html",b)}var b;return{controller:["$scope","ControlPanel","DataStore",a],restrict:"E",templateUrl:"views/post-it-wall-tpl.html"}}).animation(".post-it-item",function(){function a(a,b){var c=a.scope(),d=c.genStyle(a.attr("post-it-id"));return a.css({opacity:0,left:0,top:0,width:"100%",height:"100%"}),a.animate({opacity:1,top:d.top,left:d.left,width:d.width,height:d.height},b),function(b){b&&a.stop()}}function b(a,b){a.animate({opacity:0},b)}return{enter:a,leave:b}}),angular.module("swallApp").directive("controlPanel",function(){function a(a,b){a.panels=b.all(),a.activate=function(c){var d=b.activate(c);a.template=d.template,a.ctx=d.ctx},a.inactive=!0,a.toggle=function(){a.inactive=!a.inactive}}return{controller:["$scope","ControlPanel",a],templateUrl:"views/control-panel-tpl.html"}}),angular.module("swallApp").directive("signPad",["$window","$timeout","ControlPanel",function(a,b,c){function d(a,b){a.preview={},a.submit=function(a){b.add(a)},a.preview.update=function(b){a.preview.src=b},a.preview.confirm=function(){a.submit({src:a.preview.src}),a.preview.hide(),a.clearPad()},a.preview.show=function(){a.preview.display=!0},a.preview.hide=function(){a.preview.display=!1},a.opts={color:"red",size:15},c.add("sign pad","glyphicon-edit","views/sign-pad-panel.html",{opts:a.opts})}return{controller:["$scope","DataStore",d],scope:{},templateUrl:"views/sign-pad-tpl.html",restrict:"E",link:function(c,d){function e(){var b=a.devicePixelRatio||1;g.width=g.offsetWidth*b,g.height=g.offsetHeight*b,g.getContext("2d").scale(b,b)}var f,g=d.find("canvas")[0],h=1e3,i=function(){b.cancel(f),c.$apply(function(){c.preview.hide()})},j=function(){b.cancel(f),f=b(function(){c.updatePreview(),c.preview.show()},h)},k=new SignaturePad(g,{startFn:i,endFn:j});a.addEventListener("resize",e),e(),c.updatePreview=function(){c.preview.update(k.toDataURL())},c.clearPad=function(){k.clear()},c.$watchCollection("opts",function(){k.config({minWidth:parseFloat(c.opts.size),maxWidth:parseFloat(c.opts.size),color:c.opts.color})})}}}]),angular.module("swallApp").service("ControlPanel",function(){function a(a){return d&&(d.active=!1),d=e[a],d.active=!0,d}function b(a,b,c,d){e.push({name:a,iconClass:b,template:c,ctx:d,active:!1})}function c(){return e}var d,e=[];return{all:c,add:b,activate:a}}),angular.module("swallApp").factory("DataStore",function(){function a(a){a&&(a.id=d(),c.unshift(a))}function b(a){c.splice(a,1)}var c=[],d=function(){var a=0;return function(){var b=a;return a+=1,b}}();return{add:a,remove:b,signList:c}}),angular.module("swallApp").directive("colorpicker",function(){return{require:"?ngModel",link:function(a,b,c,d){var e={chooseText:"✓",cancelText:"×"};return d?(e.change=function(b){a.$apply(function(){d.$setViewValue(b.toName()||b.toHexString())})},b.spectrum(e),d.$render=function(){b.spectrum("set",d.$viewValue||"#fff")},void 0):(b.spectrum(e),void 0)}}}),angular.module("swallApp").directive("videoBg",["$window","ControlPanel",function(a,b){return{templateUrl:"views/video-bg-tpl.html",restrict:"EA",scope:{},link:function(c,d){function e(){h.attr("width",a.innerWidth),h.attr("height",a.innerHeight)}function f(a){return function(b){b?h.attr(a,a):h.removeAttr(a)}}function g(a){for(var b=0;b<a.length;b++){var d=a[b];c.$watch("opts."+d,f(d))}}var h=d.find("video"),i={poster:"http://video-js.zencoder.com/oceans-clip.png",src:"http://video-js.zencoder.com/oceans-clip.mp4",loop:!0,controls:!1,bgColor:"black",bg:!1};a.addEventListener("resize",e),c.init=function(){h.attr("src",i.src),h.attr("poster",i.poster),e(),g(["controls","loop","autoplay"])},c.$on("start",function(){h[0].play()}),c.opts=i,c.init(),b.add("video","glyphicon-film","views/video-bg-panel.html",{opts:i})}}}]);